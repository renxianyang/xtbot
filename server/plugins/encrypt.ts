import * as Koa from 'koa'

const jiemi1 = `var _0xodM='jsjiami.com.v7';function _0x1c30(_0x425fb6,_0x10fc27){var _0x43b220=_0x96b8();return _0x1c30=function(_0xd01ba2,_0x3cf257){_0xd01ba2=_0xd01ba2-0x99;var _0x96b843=_0x43b220[_0xd01ba2];if(_0x1c30['PHqbyu']===undefined){var _0x1c30fe=function(_0x1af196){var _0x4dea5f='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x447650='',_0x4eca42='';for(var _0x1ac281=0x0,_0x3b02ce,_0x500b44,_0x3650a5=0x0;_0x500b44=_0x1af196['charAt'](_0x3650a5++);~_0x500b44&&(_0x3b02ce=_0x1ac281%0x4?_0x3b02ce*0x40+_0x500b44:_0x500b44,_0x1ac281++%0x4)?_0x447650+=String['fromCharCode'](0xff&_0x3b02ce>>(-0x2*_0x1ac281&0x6)):0x0){_0x500b44=_0x4dea5f['indexOf'](_0x500b44);}for(var _0x1b63ac=0x0,_0x783bde=_0x447650['length'];_0x1b63ac<_0x783bde;_0x1b63ac++){_0x4eca42+='%'+('00'+_0x447650['charCodeAt'](_0x1b63ac)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x4eca42);};var _0x3d8e01=function(_0x10aa5f,_0x5e3570){var _0x3946c1=[],_0x50b0fe=0x0,_0x347789,_0x327cf0='';_0x10aa5f=_0x1c30fe(_0x10aa5f);var _0x5788b5;for(_0x5788b5=0x0;_0x5788b5<0x100;_0x5788b5++){_0x3946c1[_0x5788b5]=_0x5788b5;}for(_0x5788b5=0x0;_0x5788b5<0x100;_0x5788b5++){_0x50b0fe=(_0x50b0fe+_0x3946c1[_0x5788b5]+_0x5e3570['charCodeAt'](_0x5788b5%_0x5e3570['length']))%0x100,_0x347789=_0x3946c1[_0x5788b5],_0x3946c1[_0x5788b5]=_0x3946c1[_0x50b0fe],_0x3946c1[_0x50b0fe]=_0x347789;}_0x5788b5=0x0,_0x50b0fe=0x0;for(var _0x5906a3=0x0;_0x5906a3<_0x10aa5f['length'];_0x5906a3++){_0x5788b5=(_0x5788b5+0x1)%0x100,_0x50b0fe=(_0x50b0fe+_0x3946c1[_0x5788b5])%0x100,_0x347789=_0x3946c1[_0x5788b5],_0x3946c1[_0x5788b5]=_0x3946c1[_0x50b0fe],_0x3946c1[_0x50b0fe]=_0x347789,_0x327cf0+=String['fromCharCode'](_0x10aa5f['charCodeAt'](_0x5906a3)^_0x3946c1[(_0x3946c1[_0x5788b5]+_0x3946c1[_0x50b0fe])%0x100]);}return _0x327cf0;};_0x1c30['nDhrfU']=_0x3d8e01,_0x425fb6=arguments,_0x1c30['PHqbyu']=!![];}var _0x19123e=_0x43b220[0x0],_0x2bd4d5=_0xd01ba2+_0x19123e,_0x3933c0=_0x425fb6[_0x2bd4d5];return!_0x3933c0?(_0x1c30['ffhNNj']===undefined&&(_0x1c30['ffhNNj']=!![]),_0x96b843=_0x1c30['nDhrfU'](_0x96b843,_0x3cf257),_0x425fb6[_0x2bd4d5]=_0x96b843):_0x96b843=_0x3933c0,_0x96b843;},_0x1c30(_0x425fb6,_0x10fc27);}(function(_0x158eed,_0x1390f4,_0x1e2cd8,_0x580852,_0x8d8d21,_0x76726b,_0x31df5b){return _0x158eed=_0x158eed>>0x4,_0x76726b='hs',_0x31df5b='hs',function(_0x5bf6ea,_0x54b6e0,_0xf13779,_0x4ea1d9,_0x46702f){var _0xc43bf=_0x1c30;_0x4ea1d9='tfi',_0x76726b=_0x4ea1d9+_0x76726b,_0x46702f='up',_0x31df5b+=_0x46702f,_0x76726b=_0xf13779(_0x76726b),_0x31df5b=_0xf13779(_0x31df5b),_0xf13779=0x0;var _0x1c8bd6=_0x5bf6ea();while(!![]&&--_0x580852+_0x54b6e0){try{_0x4ea1d9=-parseInt(_0xc43bf(0xd8,'Enkj'))/0x1+-parseInt(_0xc43bf(0xaf,'poNO'))/0x2*(-parseInt(_0xc43bf(0x10c,'aQD!'))/0x3)+parseInt(_0xc43bf(0x9e,'ULk2'))/0x4+-parseInt(_0xc43bf(0xfc,'27GI'))/0x5*(parseInt(_0xc43bf(0xbe,'(8DX'))/0x6)+-parseInt(_0xc43bf(0xf3,'J$Q!'))/0x7+-parseInt(_0xc43bf(0x107,'EVW)'))/0x8+-parseInt(_0xc43bf(0xc3,'J)f&'))/0x9*(parseInt(_0xc43bf(0xe4,'7Fuc'))/0xa);}catch(_0x485e77){_0x4ea1d9=_0xf13779;}finally{_0x46702f=_0x1c8bd6[_0x76726b]();if(_0x158eed<=_0x580852)_0xf13779?_0x8d8d21?_0x4ea1d9=_0x46702f:_0x8d8d21=_0x46702f:_0xf13779=_0x46702f;else{if(_0xf13779==_0x8d8d21['replace'](/[wytXKqpeHuAEQGgUWVdr=]/g,'')){if(_0x4ea1d9===_0x54b6e0){_0x1c8bd6['un'+_0x76726b](_0x46702f);break;}_0x1c8bd6[_0x31df5b](_0x46702f);}}}}}(_0x1e2cd8,_0x1390f4,function(_0x298096,_0x4108bd,_0x4c0439,_0xedd9bb,_0x9871fb,_0x2dbc13,_0x5e0cfc){return _0x4108bd='\x73\x70\x6c\x69\x74',_0x298096=arguments[0x0],_0x298096=_0x298096[_0x4108bd](''),_0x4c0439='\x72\x65\x76\x65\x72\x73\x65',_0x298096=_0x298096[_0x4c0439]('\x76'),_0xedd9bb='\x6a\x6f\x69\x6e',(0x16985a,_0x298096[_0xedd9bb](''));});}(0xc20,0x74b27,_0x96b8,0xc4),_0x96b8)&&(_0xodM=0xc4);(function(_0x4433e8,_0xbf75e){var _0x15f631=_0x1c30,_0x198f6a={'PoNTn':function(_0x2ef2a1,_0x882c79){return _0x2ef2a1!==_0x882c79;},'zqECo':_0x15f631(0xc6,'Q5K4'),'MOHPk':function(_0xaf1ea6,_0x363871){return _0xaf1ea6===_0x363871;},'WtDhd':_0x15f631(0x101,'Enkj'),'kjFGA':_0x15f631(0x10d,'4dF6'),'iuAoK':_0x15f631(0xcd,'RYqt'),'oCXCf':_0x15f631(0x9b,'YQBA'),'pyTdP':_0x15f631(0xd4,'!wij'),'MFfvk':_0x15f631(0xbd,'dB$Y'),'tcOLB':_0x15f631(0xa8,'EVW)'),'yRdQE':_0x15f631(0xa6,'Il1!'),'gVJWl':_0x15f631(0xdf,'nntF'),'WbtCB':function(_0x4ae2c2,_0x4fea55){return _0x4ae2c2<_0x4fea55;},'JWSah':_0x15f631(0xfa,'#32#'),'ISsOg':function(_0x231a39,_0x52acc2){return _0x231a39===_0x52acc2;},'ulste':_0x15f631(0xff,'aQD!'),'jcySb':function(_0x1e3df9,_0xb9ae81){return _0x1e3df9!==_0xb9ae81;},'IZiPy':function(_0x3f2f2f,_0x25d75e){return _0x3f2f2f===_0x25d75e;},'mEkkQ':function(_0x48a3e7,_0x2026d1){return _0x48a3e7===_0x2026d1;},'TePGa':function(_0x49f66b,_0x3cb16f){return _0x49f66b<_0x3cb16f;},'ZGCma':function(_0x3add29,_0x225934){return _0x3add29!==_0x225934;},'DYxnc':_0x15f631(0xae,'!wij'),'qUoXW':_0x15f631(0xd7,'h2I%'),'bvrvK':function(_0xd84ea6,_0x208398){return _0xd84ea6(_0x208398);},'opIhK':function(_0x57e96a,_0x45dc95){return _0x57e96a(_0x45dc95);},'PWpZM':function(_0x2e92f,_0x147ecc,_0x12b0e8){return _0x2e92f(_0x147ecc,_0x12b0e8);},'RPdgm':function(_0x4298cb){return _0x4298cb();},'lLjIh':_0x15f631(0x99,'nntF')},_0x14bd58=(function(){var _0x1e15d9=!![];return function(_0x312e9d,_0x34e530){var _0x42654b=_0x1e15d9?function(){var _0xcc4800=_0x1c30;if(_0x34e530){var _0x485747=_0x34e530[_0xcc4800(0xdc,'27GI')](_0x312e9d,arguments);return _0x34e530=null,_0x485747;}}:function(){};return _0x1e15d9=![],_0x42654b;};}()),_0x53cfc8=_0x198f6a[_0x15f631(0x10a,'3S9%')](_0x14bd58,this,function(){var _0x575f16=_0x15f631,_0x406172={'wcOqG':function(_0x205e6e,_0x2923c3){var _0x2d165d=_0x1c30;return _0x198f6a[_0x2d165d(0xca,'ULk2')](_0x205e6e,_0x2923c3);},'dtpYi':_0x198f6a[_0x575f16(0xf2,'aQD!')],'JIeUZ':function(_0x382a7e,_0x30cd6c){var _0x8359e=_0x575f16;return _0x198f6a[_0x8359e(0x108,'dB$Y')](_0x382a7e,_0x30cd6c);},'CPCWw':_0x198f6a[_0x575f16(0xb5,'uH)g')],'UuMJb':_0x198f6a[_0x575f16(0xad,'WkWw')],'kFeOE':_0x198f6a[_0x575f16(0xf1,'4dF6')],'EOlHu':_0x198f6a[_0x575f16(0x110,'[WOH')],'rTiVh':_0x198f6a[_0x575f16(0xb0,'!wij')],'nlRVN':_0x198f6a[_0x575f16(0xbc,'nntF')],'eESkR':_0x198f6a[_0x575f16(0x102,'ULk2')],'BmFar':_0x198f6a[_0x575f16(0xb3,'3DXD')],'zfONm':_0x198f6a[_0x575f16(0x104,'h2I%')],'fnorX':function(_0x2f695,_0x595099){var _0x29ae69=_0x575f16;return _0x198f6a[_0x29ae69(0xa0,'!wij')](_0x2f695,_0x595099);},'ZKGKH':_0x198f6a[_0x575f16(0xe5,'3S9%')]};if(_0x198f6a[_0x575f16(0xb6,'wt^X')](_0x198f6a[_0x575f16(0x100,'wt^X')],_0x198f6a[_0x575f16(0xcc,'YQBA')])){var _0x8c086f=_0x198f6a[_0x575f16(0xbb,'cMkV')](typeof window,_0x198f6a[_0x575f16(0xb9,'27GI')])?window:_0x198f6a[_0x575f16(0x9a,'ptZK')](typeof process,_0x198f6a[_0x575f16(0xa1,'Wh6M')])&&_0x198f6a[_0x575f16(0xab,'2*i9')](typeof require,_0x198f6a[_0x575f16(0xe8,'Il1!')])&&_0x198f6a[_0x575f16(0xe7,'h2I%')](typeof global,_0x198f6a[_0x575f16(0xfb,'Il1!')])?global:this,_0x100a6c=_0x8c086f[_0x575f16(0xd5,'2*i9')]=_0x8c086f[_0x575f16(0xac,'YQBA')]||{},_0x56d1b7=[_0x198f6a[_0x575f16(0xb8,'R[hA')],_0x198f6a[_0x575f16(0x106,'Wh6M')],_0x198f6a[_0x575f16(0xf7,'Bto4')],_0x198f6a[_0x575f16(0xf8,'aQD!')],_0x198f6a[_0x575f16(0xa3,'h2I%')],_0x198f6a[_0x575f16(0xd3,'Tce3')],_0x198f6a[_0x575f16(0xaa,'aQD!')]];for(var _0x355af3=0x0;_0x198f6a[_0x575f16(0xa9,'zfA#')](_0x355af3,_0x56d1b7[_0x575f16(0xb4,'(8DX')]);_0x355af3++){if(_0x198f6a[_0x575f16(0xce,'Q5K4')](_0x198f6a[_0x575f16(0xc8,'sFVo')],_0x198f6a[_0x575f16(0xea,'Tce3')])){var _0x2e8dc2=_0x1b63ac?function(){var _0x232442=_0x575f16;if(_0x347789){var _0x53e109=_0x1de508[_0x232442(0xd0,'(8DX')](_0x2b0c74,arguments);return _0x60376=null,_0x53e109;}}:function(){};return _0x50b0fe=![],_0x2e8dc2;}else{var _0x4a0b9b=_0x198f6a[_0x575f16(0xba,'Il1!')][_0x575f16(0xc0,'5MxG')]('|'),_0x4b61e3=0x0;while(!![]){switch(_0x4a0b9b[_0x4b61e3++]){case'0':_0x2e05ac[_0x575f16(0x9d,'5MxG')]=_0x4e4082[_0x575f16(0xdb,'(8DX')][_0x575f16(0xe6,'[j@8')](_0x4e4082);continue;case'1':_0x100a6c[_0x12dd61]=_0x2e05ac;continue;case'2':_0x2e05ac[_0x575f16(0xd9,'2*i9')]=_0x14bd58[_0x575f16(0x111,'U9Af')](_0x14bd58);continue;case'3':var _0x12dd61=_0x56d1b7[_0x355af3];continue;case'4':var _0x2e05ac=_0x14bd58[_0x575f16(0xcf,'Wh6M')][_0x575f16(0xdd,'7Fuc')][_0x575f16(0xc5,'3S9%')](_0x14bd58);continue;case'5':var _0x4e4082=_0x100a6c[_0x12dd61]||_0x2e05ac;continue;}break;}}}}else{var _0x1ca5a1=Dgtcds[_0x575f16(0xc2,'U9Af')](typeof _0x53403e,Dgtcds[_0x575f16(0xda,'cMkV')])?_0x458abb:Dgtcds[_0x575f16(0xe3,'[WOH')](typeof _0x310c21,Dgtcds[_0x575f16(0x10e,'FhSU')])&&Dgtcds[_0x575f16(0xfe,'RYqt')](typeof _0xc2b002,Dgtcds[_0x575f16(0xeb,'R[hA')])&&Dgtcds[_0x575f16(0xe9,'Bto4')](typeof _0x48d91f,Dgtcds[_0x575f16(0xa5,'ghkg')])?_0x1aaa41:this,_0xc562a4=_0x1ca5a1[_0x575f16(0xa2,'R[hA')]=_0x1ca5a1[_0x575f16(0xd1,'aQD!')]||{},_0x4466fc=[Dgtcds[_0x575f16(0x9c,'sFVo')],Dgtcds[_0x575f16(0xbf,'J)f&')],Dgtcds[_0x575f16(0xde,'J)f&')],Dgtcds[_0x575f16(0xa4,'h2I%')],Dgtcds[_0x575f16(0xb2,'#32#')],Dgtcds[_0x575f16(0xee,'[WOH')],Dgtcds[_0x575f16(0xa7,'J)f&')]];for(var _0x50679a=0x0;Dgtcds[_0x575f16(0xf5,'X7#u')](_0x50679a,_0x4466fc[_0x575f16(0xe0,'Yd48')]);_0x50679a++){var _0x2cb014=Dgtcds[_0x575f16(0x113,'4dF6')][_0x575f16(0xc4,'sFVo')]('|'),_0xfc582a=0x0;while(!![]){switch(_0x2cb014[_0xfc582a++]){case'0':var _0x589bf0=_0xc562a4[_0x1e9f09]||_0x5dbbc7;continue;case'1':_0xc562a4[_0x1e9f09]=_0x5dbbc7;continue;case'2':_0x5dbbc7[_0x575f16(0xef,'nUp9')]=_0x589bf0[_0x575f16(0xed,'Bto4')][_0x575f16(0xf0,'dB$Y')](_0x589bf0);continue;case'3':var _0x5dbbc7=_0x28a59f[_0x575f16(0x10b,'dB$Y')][_0x575f16(0xd6,'4dF6')][_0x575f16(0xcb,'EVW)')](_0x344be4);continue;case'4':_0x5dbbc7[_0x575f16(0x10f,'sFVo')]=_0x2a1345[_0x575f16(0xf9,'YQBA')](_0xdde275);continue;case'5':var _0x1e9f09=_0x4466fc[_0x50679a];continue;}break;}}}});_0x198f6a[_0x15f631(0xb1,'4dF6')](_0x53cfc8),window[_0x15f631(0x9f,'2*i9')][_0x198f6a[_0x15f631(0xd2,'Wh6M')]]={},window[_0x15f631(0xe2,'sFVo')]=_0x9efa36=>{var _0x159211=_0x15f631;return JSON[_0x159211(0x105,'Bto4')](_0x198f6a[_0x159211(0x103,'27GI')](decodeURIComponent,_0x198f6a[_0x159211(0x112,'5MxG')](atob,_0x9efa36)));};}(window,document));function _0x96b8(){var _0x24a2ca=(function(){return[_0xodM,'gVrjsjUWieyawEmdqiX.QctoKm.VpvH7GpAVdWuQ==','WO7dImosvq','W5hcVvpcRmo5','kufHW6Th','WRC4fuiikSoCW7VdOKm','W5VdMq/cO1i','WRbYf8oa','W7VcN30hWOW','W4RcOKNcSmoaWPJdMmo5','W4XGd8kOWQRcNISaW6tdPdhcHCoK','W4iGBqVdP38','W7y1W5NcN8o2','W6ysWPBcReK','WPHuzCoQWPFcH8oZ','zfRcT8kuW6O','FLxcQSkoW6y','n2KbW5NdPW','W6ZcJmoft1q','lN5pWP9Y','zSksbhWqjSo7kGK','W5VcMCkAWPdcTa','i8kDW4uNWOq','W5GoDJldSa','WQr8c8oDWOtdPJ0','f8kdxYBcIq','W4CYW77cSCoK','WPfJywaJWONcRfxdT8k3ja','W5eUW7NcUmoK','ivPcW4DI','eSouWRxdN0q','FJSdW6qe','W446FSo2W4b/','W5q2W4TwzW','W7lcVwKsWRK','WONcKvmiDCobWQusWORcGean','WPjosSo2WRm','W5zqwHNcHG','W6NcUmoiE2y','ustdIr1a','WOixeLSx','ubxcMHC6'].concat((function(){return['WPnTuCoBW5zaW63dGW','evDSWPLQ','W43cVxBcRCog','j8o1WOldRWKYD2ldQ8kgzcddUa','WPVdGSoZqge','zY80W6iUqmkDWQ7cPmoHrG','W6pcQxqHWR0','WQlcK8oBWO4','ymkUW5dcVfTTkwddTq','WQldRYGMWR06bG5y','W5tcGgaMWQO','WRf1WRClnCkfWQrBD8oIEq','WQ46D8okW7a','yCkdcx0','WRj/fSoAWO4','CWFcNa','t8khW7FcTfW','W5ijWRZcT1L3rbZdNNtdJW','W4mVymo9W40','j8kKW6edWOCdmW','W50QWRJcJuu','l8khWR/dRuO','W4G5W4VcSW','W7i7CrhdPNrH','a3HjW5rGD8obdKC','jexdI8kKWP3cP8oMAHCKW4q','WQn6cSojW4pdTZboumkMhCoV','W44lBXddPMXRW5VdGG','xZpdGbDl','W5yWq8oLW4z+W6tdQW','W41rBZBcKa','uCkNW77dO2GltMvo','jKXPWOD3','WRSJfu4z','WR3cKmobaCkNjG','zs44WRHPzmkMWPlcPG','W7RcSh0LWQbn','W7ldRabOgG','e8oJWQhdUxm5Evbs','WORcRCoMWOTa','WOldQCodWOG','FxZcK8kZW7K'].concat((function(){return['W7pcH8oHzha','cmoIW4RdJdq','eSkmWQpdKMW','WQ5orSotWPO','jSo3WOddQGXgdvFdVCk0wW','nSoeW7ZdRrZdKmogWPu','W7RdIcnCmG','oCo+AmoJAv9hma','vW7cHHW','gN9NW49e','pSk6W4OZWOC','WR/dVIuLWOPye8oqWPJcTvVdQx8','WRdcNSo1Dmo4WOrIW4i','WPZcMtNcRMi','WQjKk1hcUI48W77dSmolACkupa','mSosW7VdVt4','cCknW6KgWOm','WQv6c8ok','rmoTW5pdIcBcMgNcU8oZFei','W4/cMCoJs1u','WP0ykgNdMMNcUY7dON/cG8kn','qJWwWPy3mCkkcgL7k8kuW7S','vshcNSodvW','aCkpW7SNWQm','W47cGMKPWRS','W70SvSkzWPxcTa','WOO2DSosW5W','W45xBsZcOG','D2/cSSkpW4q','mSokW53dQGS','W54LWORcH0S','mmoAuYPtzmkQpWRcUYRcImo0','EcJcOcGJ','qJmrWPm8nSolcvrxnmkB','WPdcRCofWRbL','vGJcHGS8WOr+nSoJWOvr','DCo9WRCzWP4jjZ5e','fx9iW4n7ASoxea','yCoGmCkgvW','W4/cHMG6WQyijXr+','W5FdPJ1+jG'];}()));}()));}());_0x96b8=function(){return _0x24a2ca;};return _0x96b8();};var version_ = 'jsjiami.com.v7';`

export const encryptPlugin = (app: Koa) => {
  app.use(async (ctx, next) => {
    await next()

    // dev 不处理
    if ($g.isDev) return

    // 不是api，不处理
    if (!ctx.request.path.startsWith('/api')) {
      return
    }

    ctx.body = {
      js: jiemi1,
      export: 'jiemi1',
      data: btoa(encodeURIComponent(JSON.stringify(ctx.body))),
    }
  })
}
